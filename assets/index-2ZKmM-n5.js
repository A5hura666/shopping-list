(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}})();function c(o){const r=document.getElementById("liste-produits");r.innerHTML="";const n=o.length;o.forEach(e=>{const t=document.createElement("li");t.classList.add("bg-white","rounded-lg","shadow-md","p-4","flex","flex-col","items-center","text-center","transition-transform","duration-300","hover:shadow-lg","hover:-translate-y-1"),t.innerHTML=`
        <div class="mb-4">
            <h2 class="card-title text-xl text-gray-800">${e.nom}</h2>
            <p class="text-gray-600 mt-2">Quantité : <span class="stock">${e.quantite_stock}</span></p>
            <p class="text-indigo-600 font-bold mt-2">${e.prix_unitaire} €</p>
        </div>
        <button class="bg-blue-500 text-white px-4 py-2 rounded cursor-pointer w-full
                       hover:bg-blue-600 active:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400"
                data-id="${e.nom}">
            Ajouter à la liste
        </button>
    `,r.appendChild(t)}),document.querySelectorAll("button[data-id]").forEach(e=>{e.addEventListener("click",()=>d(o,e))}),m(n)}function l(o,r){const n=document.createElement("div");n.classList.add("fixed","bottom-5","right-5","bg-green-500","text-white","px-4","py-2","rounded","shadow-lg","transition-opacity","duration-500"),n.innerText=`${o} ajouté au panier (${r})`,document.body.appendChild(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>n.remove(),500)},2e3)}function d(o,r){const n=r.getAttribute("data-id"),s=JSON.parse(localStorage.getItem("produits"))||o,e=s.find(u=>u.nom===n);if(!e||e.quantite_stock<=0){alert("Ce produit n'est plus en stock !");return}let t=JSON.parse(localStorage.getItem("panier"))||[];const i=t.find(u=>u.nom===e.nom);i?i.quantite_stock+=1:t.push({...e,quantite_stock:1}),e.quantite_stock-=1,localStorage.setItem("panier",JSON.stringify(t)),localStorage.setItem("produits",JSON.stringify(s));const a=r.parentElement?r.parentElement.querySelector(".stock"):null;a&&(a.innerText=e.quantite_stock),l(e.nom,i?i.quantite_stock:1)}function m(o){const r=document.getElementById("compteur-produits");r.innerText=o?`${o} produits`:"Aucun produit trouvé"}function p(o,r){return o.filter(n=>n.nom.toLowerCase().includes(r.toLowerCase()))}function f(o){return o.sort((r,n)=>r.prix_unitaire-n.prix_unitaire)}function g(o){return o.sort((r,n)=>r.nom.localeCompare(n.nom))}function h(){const o=document.getElementById("recherche"),r=document.getElementById("tri");o.value="",r.value="default",c(produits)}document.addEventListener("DOMContentLoaded",async()=>{let o;localStorage.getItem("produits")?o=JSON.parse(localStorage.getItem("produits")):(o=await(await fetch("/liste_produits_quotidien.json")).json(),localStorage.setItem("produits",JSON.stringify(o)));const r=document.getElementById("recherche"),n=document.getElementById("tri");document.getElementById("reset-filtres").addEventListener("click",h),n.addEventListener("change",e=>{let t=[...o];e.target.value==="prix"?t=f(t):e.target.value==="nom"&&(t=g(t)),c(t)}),r.addEventListener("input",()=>{const e=r.value,t=p(o,e);c(t)}),c(o)});
